{"version":3,"sources":["meteor://ðŸ’»app/imports/api/apixu.js","meteor://ðŸ’»app/imports/api/darkSky.js","meteor://ðŸ’»app/imports/api/data.js","meteor://ðŸ’»app/imports/api/weatherStation.js","meteor://ðŸ’»app/server/main.js"],"names":["module","export","apixu","moment","watch","require","default","v","callback","startDate","formatedDate","format","Meteor","call","err","apixuData","apixuDataCurrent","apixuParsedData","apixuParsedCurrentData","data","forecast","forecastday","hour","forEach","push","temperature","temp_c","humidity","date","Date","time_epoch","getTime","current","last_updated_epoch","sort","a","b","historic","darkSky","currentTime","Math","round","darkSkyData","darkSkyParsedData","darkSkyParsedCurrentData","hourly","time","currently","postDataLoader","HTTP","weatherStation","callService","type","url","options","Promise","resolve","reject","error","result","getDiffVector","weatherStationData","dataVect","iTemp","iHumidity","diffTemp","diffHumidity","diff","record","sumTemperature","sumHumidity","nTemperature","nHumidity","actualTime","i","length","delta","abs","props","onData","e","match","params","d","setHours","midnight","isServer","methods","getPage","then","catch","Error","message","headers","weatherStationDataCurrent","WSParsedData","WSCurrentData","hits","hit","_source","attribute","value","TP","HD","lastDate","startup"],"mappings":"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","file":"/app.js","sourcesContent":["export {apixu}\nimport moment from 'moment'\nfunction apixu(callback,startDate){\n  var formatedDate = moment(startDate).format('YYYY-MM-DD')\n  Meteor.call('getPage','http://api.apixu.com/v1/history.json?key=05d72599bed946d8983155015170512&q=Caparica&dt='+formatedDate,function(err,apixuData){\n    Meteor.call('getPage','http://api.apixu.com/v1/current.json?key=05d72599bed946d8983155015170512&q=Caparica',function(err,apixuDataCurrent){\n      var apixuParsedData = [];\n      var apixuParsedCurrentData = {};\n      if(apixuData){\n        if(apixuData.data)\n        {\n          if(apixuData.data.forecast){\n            if(apixuData.data.forecast.forecastday){\n              if(apixuData.data.forecast.forecastday[0]){\n                if(apixuData.data.forecast.forecastday[0].hour){\n                  apixuData.data.forecast.forecastday[0].hour.forEach(hour=>{\n                    apixuParsedData.push({\n                      temperature:hour.temp_c,\n                      humidity: hour.humidity,\n                      date:(new Date(hour.time_epoch*1000)).getTime()\n                    })\n                  })\n\n                }\n              }\n            }\n          }\n        }\n      }\n      if(apixuDataCurrent){\n        if(apixuDataCurrent.data)\n        {\n          if(apixuDataCurrent.data.current){\n            apixuParsedCurrentData = {\n              date: (new Date(apixuDataCurrent.data.current.last_updated_epoch*1000)).getTime(),\n              temperature: apixuDataCurrent.data.current.temp_c,\n              humidity: apixuDataCurrent.data.current.humidity\n            }\n          }\n        }\n      }\n      apixuParsedData.sort(function(a,b) {return (a.date > b.date) ? 1 : ((b.date > a.date) ? -1 : 0);} );\n      callback({\n        historic: apixuParsedData,\n        current: apixuParsedCurrentData\n      },startDate);\n    });\n  });\n}\n","export {darkSky}\n\nfunction darkSky(callback,startDate){\n\n  var currentTime = Math.round((new Date(startDate)).getTime()/1000)\n  Meteor.call('getPage','https://api.darksky.net/forecast/7902d68f0b5648cce7b9b12139451974/38.67,-9.2,'+currentTime+'?units=si',function(err,darkSkyData){\n    //Meteor.call('getPage','https://api.darksky.net/forecast/7902d68f0b5648cce7b9b12139451974/38.67,-9.2?units=si',function(err,darkSkyDataLast){\n\n    //Meteor.call('getPage','http://www.sapo.pt',function(err,darkSkyData){\n      var darkSkyParsedData = [];\n      var darkSkyParsedCurrentData = {}\n      if(darkSkyData){\n        if(darkSkyData.data){\n          if(darkSkyData.data.hourly){\n            if(darkSkyData.data.hourly.data){\n              darkSkyData.data.hourly.data.forEach(data=>{\n                darkSkyParsedData.push({\n                  temperature:data.temperature,\n                  humidity: data.humidity*100,\n                  date:(new Date(data.time*1000)).getTime()\n                })\n              })\n            }\n          }\n        }\n      }\n      if(darkSkyData){\n        if(darkSkyData.data)\n        {\n          if(darkSkyData.data.currently)\n          {\n            darkSkyParsedCurrentData = {\n              date: (new Date(darkSkyData.data.currently.time*1000)).getTime(),\n              temperature: darkSkyData.data.currently.temperature,\n              humidity: darkSkyData.data.currently.humidity*100\n            }\n          }\n        }\n      }\n      darkSkyParsedData.sort(function(a,b) {return (a.date > b.date) ? 1 : ((b.date > a.date) ? -1 : 0);} );\n      callback({\n        historic: darkSkyParsedData,\n        current: darkSkyParsedCurrentData\n      },startDate);\n    //});\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport { HTTP } from 'meteor/http';\nimport {weatherStation} from './weatherStation.js'\nimport {apixu} from './apixu.js'\nimport {darkSky} from './darkSky.js'\nimport moment from 'moment'\nexport {postDataLoader}\n\nconst callService = (type, url, options) => new Promise((resolve, reject) => {\n  HTTP.call(type, url, options, (error, result) => {\n    if (error) {\n      reject(error);\n    } else {\n      resolve(result);\n    }\n  });\n});\n\nfunction getDiffVector(weatherStationData,dataVect){\n  var iTemp = 0;\n  var iHumidity = 0;\n  var diffTemp = [];\n  var diffHumidity = [];\n  var diff = []\n  if(dataVect.historic){\n    dataVect.historic.forEach(record=>{\n      var sumTemperature = null;\n      var sumHumidity = null;\n      var nTemperature = 0;\n      var nHumidity = 0;\n      var actualTime = (new Date()).getTime();\n      if(record.date<actualTime)\n      {\n        if(weatherStationData.historic){\n          for(var i=0;i<weatherStationData.historic.length;i++)\n          {\n            var delta = record.date-weatherStationData.historic[i].date\n            if(delta<3600000 && delta>0){\n              if(weatherStationData.historic[i].temperature)\n              {\n                sumTemperature = sumTemperature + weatherStationData.historic[i].temperature\n                nTemperature = nTemperature + 1;\n              }\n              if(weatherStationData.historic[i].humidity)\n              {\n                sumHumidity = sumHumidity + weatherStationData.historic[i].humidity\n                nHumidity = nHumidity + 1;\n              }\n            }else if(delta <0){\n              break;\n            }\n          }\n          if(sumTemperature && sumHumidity)\n          {\n            diff.push({\n              date: record.date,\n              temperature: Math.abs(sumTemperature/nTemperature - record.temperature),\n              humidity: Math.abs(sumHumidity/nHumidity - record.humidity)\n            })\n\n          }\n        }\n      }\n\n    })\n  }\n  return diff\n}\n\nfunction postDataLoader(props, onData,e) {\n\n  var date = new Date(props.match.params.date).getTime();\n  var d = new Date();\n  d.setHours(0,0,0,0);\n  var midnight = d.getTime();\n  var startDate = date?date:midnight;\n\n  // load data from the server. (using props.id to identify the post)\n  // (Here'll we'll use setTimeout for demonstration purpose)\n  weatherStation(function(weatherStationData,startDate){\n    apixu(function(apixuData,startDate){\n      darkSky(function(darkSkyData,startDate){\n        apixuData.diff = getDiffVector(weatherStationData,apixuData)\n        darkSkyData.diff = getDiffVector(weatherStationData,darkSkyData)\n        onData(null, {\n          weatherStation: weatherStationData,\n          apixu: apixuData,\n          darkSky: darkSkyData,\n          startDate: moment(startDate).format('YYYY-MM-DD')\n        })\n      },startDate);\n    },startDate);\n  },startDate)\n}\nif(Meteor.isServer){\n  Meteor.methods({\n    getPage(url,options) {\n      return callService(\n        'GET',\n        url,\n        options\n      ).then((result) => result).catch((error) => {\n        throw new Meteor.Error('500', `${error.message}`);\n      });\n    },\n  });\n}\n","export {weatherStation}\nimport moment from 'moment'\nfunction weatherStation(callback,startDate){\n  var formatedDate = moment(startDate).format('YYYY-MM-DD')\n  Meteor.call('getPage','http://elasticsearch.waziup.io/waziup-ui-weather/_search?q=name:WeatherStationUI&sort=time:desc&size=6000&q=time:'+formatedDate,function(err,weatherStationData){\n    //Meteor.call('getPage','http://elasticsearch.waziup.io/waziup-ui-weather/_search?q=name:WeatherStationUI&sort=time:desc&size=1',function(err,weatherStationDataLast){\n\n      Meteor.call('getPage','http://broker.waziup.io/v2/entities/WeatherStationUI',{\n        headers: {\n            \"Fiware-ServicePath\":\"/UI/WEATHER\",\n            \"Fiware-Service\":\"waziup\"\n          }\n        },function(err,weatherStationDataCurrent){\n          var WSParsedData = [];\n          var WSCurrentData = {}\n          var d = new Date();\n          d.setHours(0,0,0,0);\n          var midnight = d.getTime();\n          if(weatherStationData.data)\n          {\n            if(weatherStationData.data.hits)\n            {\n              if(weatherStationData.data.hits.hits)\n              {\n                if(weatherStationData.data.hits.hits.length)\n                {\n                  weatherStationData.data.hits.hits.forEach(hit=>{\n                    if((new Date(hit._source.time)).getTime()>midnight-3600000 || true){\n                      if(hit._source)\n                      {\n                        if(hit._source.attribute==\"TP\")\n                        {\n                          WSParsedData.push({\n                            date:(new Date(hit._source.time)).getTime(),\n                            temperature:hit._source.value\n                          })\n                        }\n                        if(hit._source.attribute==\"HD\")\n                        {\n                          WSParsedData.push({\n                            date:(new Date(hit._source.time)).getTime(),\n                            humidity:hit._source.value\n                          })\n                        }\n                      }\n                    }\n                  })\n                }\n              }\n            }\n          }\n          WSParsedData.sort(function(a,b) {return (a.date > b.date) ? 1 : ((b.date > a.date) ? -1 : 0);} );\n          if(weatherStationDataCurrent.data)\n          {\n            if(weatherStationDataCurrent.data){\n              var temperature = null;\n              for(var i=WSParsedData.length-1;i>0;i--)\n              {\n                if(WSParsedData[i].temperature){\n                  temperature = WSParsedData[i].temperature\n                  break;\n                }\n              }\n              var humidity = null;\n              for(var i=WSParsedData.length-1;i>0;i--)\n              {\n                if(WSParsedData[i].humidity){\n                  humidity = WSParsedData[i].humidity\n                  break;\n                }\n              }\n              if(weatherStationDataCurrent.data.TP){\n                //WSCurrentData.temperature = weatherStationDataCurrent.data.TP.value\n                WSCurrentData.temperature = temperature\n              }\n              if(weatherStationDataCurrent.data.HD){\n                //WSCurrentData.humidity = weatherStationDataCurrent.data.HD.value\n                WSCurrentData.humidity = humidity\n              }\n              var lastDate = null;\n              /*if(weatherStationDataLast){\n                if(weatherStationDataLast.data){\n                  if(weatherStationDataLast.data.hits){\n                    if(weatherStationDataLast.data.hits.hits){\n                      if(weatherStationDataLast.data.hits.hits.length){\n                        lastDate = weatherStationDataLast.data.hits.hits[0].sort[0]\n                      }\n                    }\n                  }\n                }\n              }*/\n              if(WSParsedData.length){\n                WSCurrentData.date = WSParsedData[WSParsedData.length-1].date\n              }\n            }\n          }\n          callback({\n            historic: WSParsedData,\n            current: WSCurrentData\n          },startDate);\n      })\n    //});\n  })\n}\n","import { Meteor } from 'meteor/meteor';\nimport '../imports/api/data.js'\nMeteor.startup(() => {\n  // code to run on server at startup\n});\n"]}